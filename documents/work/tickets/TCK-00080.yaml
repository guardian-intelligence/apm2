ticket_meta:
  schema_version: "2026-01-25"
  template_version: "2026-01-25"
  ticket:
    id: "TCK-00080"
    title: "Configure mold linker in .cargo/config.toml"
  binds:
    prd_id: "NONE"
    rfc_id: "RFC-0007"
    requirements:
      - requirement_id: "PERF-001"
        requirement_ref: "documents/rfcs/RFC-0007/01_problem_and_imports.yaml#rfc_local_requirements.requirements[0]"
    evidence_artifacts:
      - "EVID-7001"
  custody:
    agent_roles:
      - "AGENT_IMPLEMENTER"
    responsibility_domains:
      - "DOMAIN_BUILD_RELEASE"
  dependencies:
    tickets: []
  scope:
    in_scope:
      - "Add [target.x86_64-unknown-linux-gnu] section to .cargo/config.toml"
      - "Set linker = \"clang\""
      - "Set rustflags to use mold via -fuse-ld=mold"
      - "Add comment explaining the configuration"
      - "Preserve existing [alias] section"
    out_of_scope:
      - "macOS mold configuration"
      - "Windows linker configuration"
      - "CI workflow changes"
      - "Installing mold (already present at /usr/bin/mold)"
  plan:
    steps:
      - "Read current .cargo/config.toml to understand existing structure"
      - "Add [target.x86_64-unknown-linux-gnu] section after existing content"
      - "Set linker = \"clang\" to use clang as the linker driver"
      - "Set rustflags = [\"-C\", \"link-arg=-fuse-ld=mold\"] to use mold"
      - "Add comment explaining the configuration and fallback behavior"
      - "Verify cargo build -vv shows mold being used"
      - "Verify cargo build --workspace succeeds"
      - "Verify cargo test --workspace passes"
      - "Verify cargo clippy passes with no warnings"
  definition_of_done:
    evidence_ids:
      - "EVID-7001"
    criteria:
      - ".cargo/config.toml contains [target.x86_64-unknown-linux-gnu] section"
      - "linker = \"clang\" is configured"
      - "rustflags includes -fuse-ld=mold"
      - "Comment explains the configuration"
      - "cargo build -vv 2>&1 | grep mold shows mold is used"
      - "cargo build --workspace succeeds"
      - "cargo test --workspace passes"
      - "cargo clippy passes with no warnings"
      - "Developers on non-Linux platforms are unaffected"
  notes:
    security: |
      No security implications. mold is a standard, widely-used linker that
      produces functionally identical binaries to ld. The configuration only
      affects the build process, not the resulting binaries' behavior.
    fallback_behavior: |
      The configuration is target-specific (x86_64-unknown-linux-gnu only):
      - macOS developers: Unaffected, uses default macOS linker (ld64)
      - Windows developers: Unaffected, uses default MSVC linker
      - ARM64 Linux: Unaffected unless separate target section is added
      - If mold/clang missing: Build fails with clear error message
        Developer can comment out the section to use default linker
    implementation_details: |
      The .cargo/config.toml should look like this after the change:

      ```toml
      [alias]
      xtask = "run --package xtask --"

      # Use mold linker for faster linking on Linux
      # mold is significantly faster than ld/gold for debug builds
      # If mold is not installed, comment out this section or install:
      #   Ubuntu: apt install mold
      #   Fedora: dnf install mold
      #   Arch: pacman -S mold
      [target.x86_64-unknown-linux-gnu]
      linker = "clang"
      rustflags = ["-C", "link-arg=-fuse-ld=mold"]
      ```

      Requirements:
      - mold must be installed (verified: /usr/bin/mold exists)
      - clang must be installed (required as linker driver)

      Verification:
      ```bash
      cargo build -vv 2>&1 | grep -E '(mold|fuse-ld=mold)'
      ```
    affected_files: |
      Modified: .cargo/config.toml (add mold linker configuration)
