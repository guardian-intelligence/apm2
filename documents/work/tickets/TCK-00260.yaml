acceptance_criteria:
  - criterion: Tool not in allowlist rejected
    verification: Request for unlisted tool returns TOOL_NOT_ALLOWED
  - criterion: Validation overhead <5ms p50
    verification: Benchmark BENCH-003 passes
implementation:
  code_examples: []
  files_to_create: []
  files_to_modify:
    - changes: "Implement RequestTool handler.\nValidate tool_id against capability manifest.\n"
      path: crates/apm2-daemon/src/handlers.rs
    - changes: "Extend validate_tool_request for manifest validation.\n"
      path: crates/apm2-daemon/src/session/consume.rs
    - changes: "Add capability manifest validation to tool broker.\n"
      path: crates/apm2-daemon/src/episode/broker.rs
  implementation_steps: []
  summary: ""
notes: "Phase: PHASE-3\nGenerated from RFC RFC-0017 ticket decomposition on 2026-01-30."
schema_version: "2026-01-26"
template_version: "2026-01-26"
test_requirements:
  - description: Unit tests pass
    test_id: UT-00260-01
    verification_command: cargo test -p apm2-core tck_00260
  - description: Integration test
    test_id: IT-00260-01
    verification_command: cargo run --bin apm2 -- factory tickets emit --rfc RFC-0017
ticket:
  depends_on: []
  id: TCK-00260
  requirement_ids:
    - REQ-DCP-0011
  rfc_id: RFC-0017
  status: READY
  title: Implement tool broker with capability manifest validation
