prd_evidence_artifact:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "EVID-0003"
  category: "INTEGRATION_TEST_RESULTS"
  title: "Projection Divergence Detection Tests"
  description: |
    Tests verifying projection divergence detection between external trunk and internal
    MergeReceipt truth. Divergence must emit PROJECTION_DIVERGENCE defect and trigger
    InterventionFreeze for the affected repository.
  source_acceptance_test: FAC-AT-0003
  capture:
    paths:
      - "test/fac/projection_divergence/"
      - "test/fac/divergence_watchdog/"
  verification:
    commands:
      - id: "CMD-0001"
        shell: "bash"
        command: "cargo test --workspace -- projection::divergence_detection"
        expected_exit_code: 0
        cwd: "."
        timeout_seconds: 180
        network_access: "DISALLOWED"
        allowlist_hosts: []
        constraints:
          - "Mock external trunk state available"
          - "MergeReceipt fixtures with result_selector present"
  assertions:
    - "PROJECTION_DIVERGENCE defect emitted when external trunk diverges from MergeReceipt"
    - "Defect record includes observed head and expected head"
    - "Divergence triggers InterventionFreeze(scope=repo)"
    - "New FAC admissions blocked for repo during freeze"
  data:
    classification: "INTERNAL"
    redaction:
      required: false
      guidance: []
