prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "REQ-0013"
  type: "SECURITY"
  source_id: "FAC-REQ-0112"
  title: "AAT reuse safety and provenance"
  statement: |
    Any AAT result reuse MUST be keyed by an exact provenance tuple and emitted as
    AATResultReused with signature chain verification. Reuse is forbidden when the
    tuple does not match exactly.
  acceptance_criteria:
    - "AAT reuse is keyed by provenance tuple: changeset_digest, pinned_snapshot_digest, verifier_policy_hash, toolchain_digest, env_attestation_digest, rcp_aat_manifest_hash. Verified by: Policy validation test."
    - "Kernel emits AATResultReused event with from_receipt_hash, key_tuple, and justification, signed by admission authority. Verified by: Event emission test."
    - "Admission rejects reuse on any mismatch and emits AAT_CACHE_KEY_MISMATCH. Verified by: Negative tests."
  evidence:
    evidence_ids:
      - EVID-0029
  law_alignment:
    - law_id: "LAW-12"
      enforcement: "Bounded retries and safe reuse policies."
      applies_to:
        - "Admission"
        - "Coordinator"
    - law_id: "LAW-15"
      enforcement: "Measurement integrity requires provenance-verified reuse."
      applies_to:
        - "AATResultReused"
        - "GateReceipt"
  defect_codes:
    - code: "AAT_CACHE_KEY_MISMATCH"
      severity: "S1"
      description: "Reuse attempted with non-matching provenance tuple"
