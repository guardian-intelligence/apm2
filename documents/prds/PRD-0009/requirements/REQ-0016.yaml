prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "REQ-0016"
  type: "SECURITY"
  source_id: "FAC-REQ-0115"
  title: "AAT harness sandboxing and egress control"
  statement: |
    AAT harness execution MUST run in a strict sandbox with no host mounts beyond
    pinned snapshots, egress deny by default, and allowlisted environment variables.
  acceptance_criteria:
    - "AAT harness runs in namespace/container sandbox; host mounts beyond pinned snapshot are denied. Verified by: Sandbox enforcement test."
    - "Network egress is deny-by-default; any allowed egress is policy-declared and recorded in receipt. Verified by: Network policy test."
    - "Environment variables are allowlisted; non-allowlisted variables are redacted from transcripts. Verified by: Env allowlist test."
  evidence:
    evidence_ids:
      - EVID-0032
  law_alignment:
    - law_id: "LAW-04"
      enforcement: "Terminal verifiers must be trustworthy; sandboxing prevents harness abuse."
      applies_to:
        - "AAT harness"
    - law_id: "LAW-05"
      enforcement: "OCAP containment and no ambient authority."
      applies_to:
        - "Sandbox"
        - "Tool policy"
  defect_codes:
    - code: "AAT_EVIDENCE_POLICY_VIOLATION"
      severity: "S1"
      description: "Harness violated sandbox or network policy"
