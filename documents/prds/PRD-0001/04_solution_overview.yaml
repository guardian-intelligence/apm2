prd_solution_overview:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  proposed_solution:
    overview: 'APM2 is a holonic node runtime (cell kernel) that enables an autonomous
      software factory. Each node supervises crash-only agent sessions and can also
      supervise child nodes recursively. All agent side effects are mediated through
      a syscall boundary (tools) that is default-deny and policy enforced. The node
      records signed kernel events to an append-only, tamper-evident ledger and computes
      deterministic projections (active leases, health, policy posture, evidence index,
      and factory KPIs) via reducer logic with checkpointing. Nodes federate over
      prioritized multiplexed links to replicate ledger segments and exchange bounded
      control commands. On top of the kernel, the Holonic Work Protocol (HWP) represents
      work as durable contracts tied to immutable spec snapshots, uses lease-based
      ownership to prevent duplicate work, supports typed collaboration (questions/answers/context
      requests), and requires evidence bundles to close work and gates. The north-star
      behavior is single-command execution of the full SDLC loop: PRD and RFC writing/refinement
      via templates, ticket decomposition, ticket claiming, implementation, review,
      merge gating, and evidence publicationâ€”without human intervention during execution.'
    key_components:
    - 'Supervisor: crash-only session management with entropy-based stall detection,
      backoff, quarantine, and deterministic exit classification.'
    - 'Harness + Adapters: vendor-agnostic wrappers that normalize session observability
      and enforce syscall mediation for tools, filesystem, network, artifacts, and
      inference.'
    - 'Policy Engine: deterministic allow/deny decisions with budget enforcement and
      audited rule IDs/policy hashes.'
    - 'Ledger: append-only, hash-chained, signed records storing kernel events and
      references to content-addressed artifacts.'
    - 'Reducers/Projections: deterministic computation of active leases, session health,
      policy posture, evidence index, and factory KPIs with checkpointing.'
    - 'Adjudicator: Autonomous coordination of agent quorums to resolve bounded-choice
      requests with enforced deadlines and fallback policies.'
    - 'Lease Registrar: Authoritative role for issuing, renewing, and reconciling
      work leases within a holonic scope.'
    - 'Rework Controller: Deterministic loop management for review-fix cycles, enforcing
      retry budgets and managing lease re-awards after rejections.'
    - 'Federation Link: QUIC-based multiplexed streams for control, replication, and
      artifact transfer with explicit prioritization.'
    - 'Work Contracts (HWP): durable work objects pinned to spec snapshots with lease-based
      claiming, typed questions/answers, and evidence publication.'
    external_dependencies:
    - Git repository and hosting provider for source, diffs, reviews, and merges.
    - A deterministic build/test toolchain available on nodes or via configured CI
      environment.
    - A local inference runtime (optional but recommended) for offline operation;
      remote inference may be used under explicit policy.
    - Secure secret storage and credential provisioning mechanism compatible with
      default-deny policies.
  interfaces:
    external_apis:
    - Repository API surface (clone/fetch/diff/merge/revert) accessed only through
      mediated tools.
    - Optional remote inference provider APIs accessed only through infer syscall
      and policy allowlists.
    - Optional metrics/tracing export endpoints for dashboards and traces.
    user_surfaces:
    - CLI for starting workflows, inspecting projections, and triggering remediation
      with machine-readable output modes.
    - Optional local control socket for CLI-to-daemon communication.
    - Artifacts and evidence bundle directory structure for post-facto inspection
      and replay.
