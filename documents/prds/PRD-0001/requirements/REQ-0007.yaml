prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0007
  type: DETERMINISM
  title: Deterministic reducers and projections
  statement: Node state used for orchestration (active work leases, session health,
    policy posture, evidence index) MUST be computed by deterministic reducers/projections
    from the ledger, with checkpointing to avoid full replay on startup.
  acceptance_criteria:
  - Given the same ledger segment set and reducer version, state projections are identical
    across runs.
  - Projections are checkpointed with 'applied_through_seq' and can be incrementally
    updated.
  - On projection loss, the system can rebuild projections from ledger segments deterministically
    and verify integrity.
  - Projection update logic is side-effect free and can be property tested (idempotency,
    monotonicity, conflict handling).
  - Conflicting lease events are represented explicitly and resolved via deterministic
    rules or explicit adjudication work items.
  evidence:
    evidence_ids:
    - EVID-0005
    - EVID-0006
