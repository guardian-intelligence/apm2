prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0012
  type: INTEROPERABILITY
  title: Canonical wire encoding and schema versioning
  statement: All signed protocol and ledger records MUST use a canonical encoding
    (e.g., protobuf) with explicit schema versions and deterministic field ordering
    rules to enable multi-language implementations and stable signature verification.
  acceptance_criteria:
  - Wire schemas forbid nondeterministic structures (e.g., maps) in signed records.
  - Repeated fields that represent sets are sorted deterministically prior to encoding.
  - Records include record_version and schema_id; upcasters transform older versions
    deterministically on read.
  - Signature verification is performed over canonical payload bytes with a domain
    separator.
  - Compatibility tests exist to ensure older node versions can interoperate within
    a defined version window.
  evidence:
    evidence_ids:
    - EVID-0008
