prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0004
  type: SECURITY
  title: Tool mediation default-deny syscall boundary
  statement: All agent side effects (filesystem writes, command execution, network
    access, secrets access, artifact publication, and inference calls) MUST be mediated
    through a syscall-like tool boundary that is default-deny and policy-enforced;
    direct side effects outside the boundary MUST be prevented or detected and treated
    as violations.
  acceptance_criteria:
  - All allowed side-effecting actions are executed only through a canonical tool
    API (e.g., cmd.run, fs.apply_patch, net.fetch, infer).
  - Any attempt to use a disallowed tool or access a forbidden resource is denied
    and recorded as a policy decision.
  - Network access is DISALLOWED by default; any exception requires explicit policy
    configuration and is logged.
  - Secrets are never exposed to agent processes by default; secrets access requires
    explicit policy grants tied to a work lease.
  - Policy violations trigger deterministic enforcement actions (deny, terminate session,
    quarantine) based on configured thresholds.
  evidence:
    evidence_ids:
    - EVID-0003
    - EVID-0013
    - EVID-0014
