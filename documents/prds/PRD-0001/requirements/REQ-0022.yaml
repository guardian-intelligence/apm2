prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0022
  type: SECURITY
  title: Key management and replay protection
  statement: Nodes MUST maintain cryptographic identity keys, sign kernel records
    and protocol messages, and implement replay protection for command-like messages
    and leases to prevent replays and spoofing under hostile conditions.
  acceptance_criteria:
  - ActorID is bound to public key material; key rotation is supported with explicit
    continuity records.
  - All command-like messages include msg_id and dedupe_key; replays are detected
    and ignored with audit records.
  - Signature verification failures are treated as policy violations and logged.
  - Trust roots for enrollment are explicit; unauthenticated peers are rejected by
    default.
  - Cryptographic domain separation is used to prevent cross-protocol signature confusion.
  evidence:
    evidence_ids:
    - EVID-0013
    - EVID-0016
