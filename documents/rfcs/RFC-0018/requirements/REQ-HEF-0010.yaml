rfc_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "REQ-HEF-0010"
  type: "FUNCTIONAL"
  title: "Reviewer viability (workspace snapshot/apply + minimal tools)"
  statement: |
    Reviewer episodes must receive a workspace snapshot/apply input derived from
    ChangeSetBundleV1, execute a minimal approved tool set (FileRead +
    GitOperation{DIFF, STATUS} + ArtifactFetch; ListFiles/Search is NEW WORK
    REQUIRED via TCK-00315), and store review outputs/logs in CAS with
    ledger-anchored receipts. GitOperation outputs are bounded
    (DIFF max_bytes=262144/max_lines=4000; STATUS max_bytes=16384/max_lines=500),
    ArtifactFetch is CAS-scoped only with max_bytes=4194304, and ShellExec is
    forbidden by default and requires explicit capability allowlist.
  acceptance_criteria:
    - "Workspace snapshot/apply succeeds for valid bundles; failures emit ReviewBlocked with CAS logs."
    - "Reviewer tool execution logs are stored in CAS and referenced by ReviewReceipt."
    - "Tool profile is enforced; unallowlisted tools are denied."
    - "GitOperation output bounds and ArtifactFetch max_bytes are enforced; violations emit ReviewBlocked with CAS logs."
  evidence:
    evidence_ids:
      - "EVID-HEF-0010"
      - "EVID-HEF-0011"
      - "EVID-HEF-0012"
    inherited_from_prd: false
    notes: []
