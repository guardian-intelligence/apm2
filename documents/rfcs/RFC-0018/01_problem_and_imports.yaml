rfc_problem_and_imports:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  imported_from_prd:
    # All refs below are relative to binds_to_prd.prd_base_path defined in 00_meta.yaml
    problem_ref: "02_problem.yaml#prd_problem"
    goals_scope_ref: "03_goals_scope.yaml#prd_goals_scope"
    constraints_invariants_ref: "06_constraints_invariants.yaml#prd_constraints_invariants"
    quality_framework_ref: "10_quality_framework.yaml#prd_quality_framework"
  protocol_profile_imports:
    required_rfc_section_refs: []
  rfc_specific_problem_detail:
    additional_context: |
      HEF Phase 1 is a latency/UX accelerant layered on FAC; it does not alter
      admission authority. Pulses are derived only after ledger commit and never
      replace ledger/CAS verification.

      Independent assessment (current maturity evidence):
      - Ledger provides append-only storage with cursor-based reads and a head
        pointer (crates/apm2-core/src/ledger/storage.rs:303-307,412-518,719-736).
      - Kernel event schema defines WorkEvent, ToolEvent, SessionEvent,
        GateReceipt, and PolicyResolvedForChangeSet payloads
        (proto/kernel_events.proto:96-239,243-282,723-791).
      - KernelEvent payload list does not include ChangeSetPublished,
        ReviewReceiptRecorded, or ReviewBlockedRecorded events
        (proto/kernel_events.proto:73-93).
      - EvidenceEvent only includes EvidencePublished and GateReceiptGenerated
        (proto/kernel_events.proto:436-466).
      - PolicyResolvedForChangeSet anchors changeset_digest but does not include
        any CAS reference to a diff bundle
        (proto/kernel_events.proto:726-744).
      - ChangeSet risk-tier input tracks file paths and counts only; no diff
        contents are represented
        (crates/apm2-core/src/fac/risk_tier.rs:292-313).
      - Episode PinnedSnapshot captures repo/lockfile/policy hashes but is not a
        review receipt or diff bundle
        (crates/apm2-daemon/src/episode/snapshot.rs:88-104).
      - ProtocolServer uses length-prefixed binary framing (max frame size
        16 MiB) with dual sockets (operator.sock/session.sock) and privilege
        separation (crates/apm2-daemon/src/protocol/mod.rs:38-48,
        crates/apm2-daemon/AGENTS.md:123-139,
        crates/apm2-daemon/src/protocol/dispatch.rs:724-783).
      - Legacy JSON IPC is forbidden in default builds (DD-009 hard cutover)
        (documents/rfcs/RFC-0017/02_design_decisions.yaml:632-649,
        crates/apm2-core/src/ipc/AGENTS.md:5-23).
      - Daemon ledger event emission for work claims is stubbed in-memory
        (StubLedgerEventEmitter) and not a persisted outbox
        (crates/apm2-daemon/src/protocol/dispatch.rs:148-169).
      - CapabilityManifest currently contains only manifest metadata and
        capabilities; it does not include pulse topic allowlists or CAS hash
        allowlists (crates/apm2-daemon/src/episode/capability.rs:511-526).
      - Runtime IPC defines EpisodeCreated/Started/Stopped but these are IPC
        messages, not ledger events (proto/apm2d_runtime_v1.proto:29-55).
      - GitHub projection is write-only; ledger remains the source of truth
        (crates/apm2-daemon/src/projection/mod.rs:4-21).
      - xtask commands directly write GitHub status checks via gh api, which is a
        bypass surface that HEF must not treat as authoritative
        (xtask/src/tasks/aat.rs:172-207, xtask/src/tasks/push.rs:353-390,
        xtask/src/tasks/review.rs:351-369,
        xtask/src/tasks/security_review_exec.rs:382-398).

      Dependencies:
      - RFC-0017 DD-009 hard cutover (ProtocolServer-only control plane) is a
        prerequisite for HEF enforcement on operator/session sockets
        (documents/rfcs/RFC-0017/02_design_decisions.yaml:632-649).
      - HEF depends on FAC receipts and evidence invariants defined in
        RFC-0015 and PRD-0009 (no new admission authority is introduced).
    out_of_scope_confirmations:
      - "No message broker, durable pubsub, or multi-host discovery (Phase 1)."
      - "No authoritative admission decisions or gate outcomes from pulses."
      - "No new truth-plane in addition to ledger+CAS."
  requirement_binding:
    bound_requirement_ids: []
    added_rfc_only_requirements:
      mode: "FILE_PER_REQUIREMENT"
      local_root: "requirements/"
      local_requirements:
        - requirement_id: "REQ-HEF-0001"
          requirement_ref: "requirements/REQ-HEF-0001.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0002"
          requirement_ref: "requirements/REQ-HEF-0002.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0003"
          requirement_ref: "requirements/REQ-HEF-0003.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0004"
          requirement_ref: "requirements/REQ-HEF-0004.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0005"
          requirement_ref: "requirements/REQ-HEF-0005.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0006"
          requirement_ref: "requirements/REQ-HEF-0006.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0007"
          requirement_ref: "requirements/REQ-HEF-0007.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0008"
          requirement_ref: "requirements/REQ-HEF-0008.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0009"
          requirement_ref: "requirements/REQ-HEF-0009.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0010"
          requirement_ref: "requirements/REQ-HEF-0010.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0011"
          requirement_ref: "requirements/REQ-HEF-0011.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0012"
          requirement_ref: "requirements/REQ-HEF-0012.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0013"
          requirement_ref: "requirements/REQ-HEF-0013.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0014"
          requirement_ref: "requirements/REQ-HEF-0014.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0015"
          requirement_ref: "requirements/REQ-HEF-0015.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0016"
          requirement_ref: "requirements/REQ-HEF-0016.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0017"
          requirement_ref: "requirements/REQ-HEF-0017.yaml#rfc_requirement"
        - requirement_id: "REQ-HEF-0018"
          requirement_ref: "requirements/REQ-HEF-0018.yaml#rfc_requirement"
      rationale: |
        HEF Phase 1 introduces pulse-plane contracts, ACLs, resource governance,
        and disclosure rules that are not explicit PRD requirements and must be
        specified at RFC granularity.
      evidence_policy: "RFC-only requirements MUST define new evidence artifacts in 07_test_and_evidence.yaml or in rfc/evidence_artifacts/."
