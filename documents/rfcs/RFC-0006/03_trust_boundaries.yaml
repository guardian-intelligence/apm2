rfc_trust_boundaries:
  schema_version: "2026-01-25"
  template_version: "2026-01-25"

  trust_model:
    description: |
      This RFC primarily addresses documentation and tooling improvements within
      the local development environment. Trust boundaries are minimal as changes
      focus on developer workflow enhancement rather than security-sensitive features.

    boundaries:
      - id: TB-001
        name: "Local Development Environment"
        description: "xtask and documentation run in developer's local environment"
        trust_level: HIGH
        entities:
          - "Developer workstation"
          - "Local git repository"
          - "Coding guidelines documentation"

      - id: TB-002
        name: "GitHub API via gh CLI"
        description: "gh CLI handles authentication for status updates"
        trust_level: DELEGATED
        entities:
          - "GitHub API"
          - "gh credential helper"

      - id: TB-003
        name: "External AI Tools"
        description: "Gemini CLI invoked as subprocess for both security and code quality reviews"
        trust_level: EXTERNAL
        entities:
          - "gemini CLI"
        notes: |
          Unification under Gemini CLI simplifies trust model - single external
          AI tool with consistent invocation pattern.

      - id: TB-004
        name: "Temporary Files"
        description: "Secure temp files for AI tool input"
        trust_level: CONTROLLED
        entities:
          - "tempfile crate NamedTempFile"
        security_properties:
          - "0600 permissions (owner read/write only)"
          - "Unpredictable file names"
          - "Automatic cleanup on drop"

  data_flows:
    - flow_id: DF-001
      description: "AI review prompt to temp file"
      from: "xtask review/push command"
      to: "NamedTempFile"
      data: "Review prompt content (markdown)"
      sensitivity: LOW
      security_controls:
        - "File permissions 0600"
        - "Unpredictable path"
        - "Auto-cleanup"

    - flow_id: DF-002
      description: "Temp file to AI tool via script"
      from: "NamedTempFile"
      to: "Gemini CLI (via script command)"
      data: "Review prompt content"
      sensitivity: LOW
      security_controls:
        - "Input redirection (no shell interpolation)"
        - "script command provides PTY"

    - flow_id: DF-003
      description: "Lint results to developer"
      from: "cargo xtask lint"
      to: "Developer terminal"
      data: "Anti-pattern warnings"
      sensitivity: NONE

  security_considerations: |
    Primary security improvement: Unified secure temp file pattern for AI tool
    invocation. The tempfile crate's NamedTempFile provides:
    - 0600 permissions (prevents other users from reading prompts)
    - Unpredictable file names (prevents symlink attacks)
    - Automatic cleanup (prevents orphaned files with sensitive content)

    The switch from Codex to Gemini CLI does not change the trust model for
    external AI tools - both are treated as EXTERNAL trust level with the same
    security controls applied.

    No credentials are handled directly by xtask; all authentication continues
    to be delegated to the gh CLI and its credential helper.
