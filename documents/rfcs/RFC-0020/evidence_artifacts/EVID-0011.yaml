evidence_artifact:
  schema_version: "2026-02-07"
  id: "EVID-0011"
  title: "O(log n) identity verifier economics evidence"
  category: "UNIT_TEST_RESULT"
  status: "PASS"
  description: |
    Evidence that REQ-0011 is implemented with explicit verifier economics
    bounds and fail-closed proof verification semantics. The daemon identity
    verifier now enforces pre-decode proof size limits, post-decode depth and
    non-default sibling limits, and a cache contract where directory heads are
    admitted once and reused for O(log n) proof verification.

    This artifact covers:
    - IdentityProofProfileV1 and VerifierCostTarget canonical/bounded decoding
    - max-depth enforcement for SMT proofs (MAX_SMT_DEPTH = 48)
    - bounded non-default sibling economics checks
    - forged/malformed proof denial behavior
    - VerifiedHeadCache head-admission + proof-verification amortization
  requirement_ids:
    - "REQ-0011"
  source_refs:
    - "documents/rfcs/RFC-0020/requirements/REQ-0011.yaml"
    - "documents/rfcs/RFC-0020/HOLONIC_SUBSTRATE_INTERFACE.md"
    - "crates/apm2-daemon/src/identity/directory_proof.rs"
    - "crates/apm2-daemon/src/identity/mod.rs"
  artifacts:
    - type: "test_output"
      description: |
        Adversarial malformed/forged proof negatives:
        - test_forged_root_hash_rejected
        - test_truncated_proof_bytes_rejected
        - test_corrupted_sibling_hash_rejected
        - test_inclusion_proof_with_wrong_key_rejected
        - test_inclusion_proof_with_wrong_value_rejected
        - test_non_membership_proof_forged_as_membership_rejected
      ref:
        - "cargo test -p apm2-daemon identity::directory_proof::tests::test_forged_root_hash_rejected"
        - "cargo test -p apm2-daemon identity::directory_proof::tests::test_truncated_proof_bytes_rejected"
        - "cargo test -p apm2-daemon identity::directory_proof::tests::test_corrupted_sibling_hash_rejected"
        - "cargo test -p apm2-daemon identity::directory_proof::tests::test_inclusion_proof_with_wrong_key_rejected"
        - "cargo test -p apm2-daemon identity::directory_proof::tests::test_inclusion_proof_with_wrong_value_rejected"
        - "cargo test -p apm2-daemon identity::directory_proof::tests::test_non_membership_proof_forged_as_membership_rejected"
    - type: "test_output"
      description: |
        Depth/sibling/profile economics bounds:
        - test_proof_exceeds_max_depth_rejected
        - test_proof_exceeds_profile_max_depth_rejected
        - directory_proof_rejects_non_default_sibling_inflation
        - identity_proof_profile_rejects_scale_target_violations
      ref:
        - "cargo test -p apm2-daemon identity::directory_proof::tests::test_proof_exceeds_max_depth_rejected"
        - "cargo test -p apm2-daemon identity::directory_proof::tests::test_proof_exceeds_profile_max_depth_rejected"
        - "cargo test -p apm2-daemon identity::directory_proof::tests::directory_proof_rejects_non_default_sibling_inflation"
        - "cargo test -p apm2-daemon identity::directory_proof::tests::identity_proof_profile_rejects_scale_target_violations"
    - type: "test_output"
      description: |
        Cache amortization contract:
        - verified_head_cache_amortizes_head_verification
        - verified_head_cache_evict_stale_entries
      ref:
        - "cargo test -p apm2-daemon identity::directory_proof::tests::verified_head_cache_amortizes_head_verification"
        - "cargo test -p apm2-daemon identity::directory_proof::tests::verified_head_cache_evict_stale_entries"
