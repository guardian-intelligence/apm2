rfc_trust_boundaries:
  schema_version: "2026-02-07"
  template_version: "2026-01-23"

  boundary_model:
    - id: "TB-0001"
      name: "Join-time authority construction"
      trust_level: "UNTRUSTED_UNTIL_PROVEN"
      statement: "Join input must bind identity/delegation/capability/freshness/stop-budget policy with fail-closed decode and policy checks."
      source_ref: "PROOF_CARRYING_AUTHORITY_CONTINUITY.md §3.1"

    - id: "TB-0002"
      name: "Revalidate before broker and before execute"
      trust_level: "POLICY_CONSTRAINED"
      statement: "Revalidation checkpoints gate stale/revoked/ambiguous authority before side effect execution."
      source_ref: "PROOF_CARRYING_AUTHORITY_CONTINUITY.md §6.1"

    - id: "TB-0003"
      name: "Consume-time acceptance"
      trust_level: "AUTHORITATIVE_IF_RECEIPT_BOUND"
      statement: "Side effect admission requires successful consume with required pre-actuation receipt linkage."
      source_ref: "PROOF_CARRYING_AUTHORITY_CONTINUITY.md §6.1"

    - id: "TB-0004"
      name: "Receipt authentication boundary"
      trust_level: "AUTHORITATIVE_ONLY_IF_PROOF_RESOLVABLE"
      statement: "Acceptance facts require direct seal or pointer/inclusion proof path; raw forwarded bytes are non-authoritative routing facts."
      source_ref: "PROOF_CARRYING_AUTHORITY_CONTINUITY.md §6.5"

    - id: "TB-0005"
      name: "Tier2+ sovereignty composition"
      trust_level: "CONTAINMENT_CRITICAL"
      statement: "Tier2+ consume composes with sovereignty epoch/revocation/freeze/autonomy-ceiling checks and denies/freeze on uncertainty."
      source_ref: "PROOF_CARRYING_AUTHORITY_CONTINUITY.md §6.6"

  replay_order_contract:
    source_ref: "PROOF_CARRYING_AUTHORITY_CONTINUITY.md §6.4"
    required_order:
      - "AuthorityJoin"
      - "AuthorityRevalidate"
      - "AuthorityConsume"
      - "EffectReceipt"
    with_preactuation:
      - "AuthorityJoin"
      - "PreActuationCheck"
      - "AuthorityRevalidate"
      - "AuthorityConsume"
      - "EffectReceipt"
    additional_rule: "AuthorityConsume must reference prior pre-actuation selector when pre-actuation is required by policy."

  threat_model:
    source_ref: "PROOF_CARRYING_AUTHORITY_CONTINUITY.md §7"
    threats:
      - id: "THR-0001"
        name: "Identity replay / stale identity"
        mitigation: "freshness+revocation-bound revalidate/consume gates"
      - id: "THR-0002"
        name: "Delegation widening / confused deputy"
        mitigation: "join-time strict-subset checks + lineage binding"
      - id: "THR-0003"
        name: "TOCTOU between check and effect"
        mitigation: "explicit revalidate and consume immediately pre-effect"
      - id: "THR-0004"
        name: "Duplicate/replayed actuation"
        mitigation: "single-use AJC consumption law + durable consume records"
      - id: "THR-0005"
        name: "Fact forgery / unverifiable claims"
        mitigation: "mandatory receipt lineage and replay-resolvable selectors"
      - id: "THR-0006"
        name: "Availability pressure"
        mitigation: "bounded join inputs + capacity-partitioned admission families"
      - id: "THR-0007"
        name: "Sovereignty uncertainty / revocation ambiguity (Tier2+)"
        mitigation: "sovereignty-anchored revalidate/consume checks with deny/freeze on uncertainty"

  invariants:
    source_ref: "PROOF_CARRYING_AUTHORITY_CONTINUITY.md §12"
    list:
      - "No authority-bearing side effect without consumed AJC."
      - "Single-consume enforcement is durable for authoritative mode."
      - "Tier2+ ambiguous freshness is deny."
      - "Delegation widening is deny."
      - "Unknown/missing required authority state is fail-closed."
      - "Containment precedence cannot be overridden by liveness optimization."
