rfc_trust_boundaries:
  schema_version: "2026-01-24"
  template_version: "2026-01-24"

  trust_model:
    description: |
      The xtask commands operate within the local development environment and
      interact with GitHub via the gh CLI. Trust boundaries are minimal as
      this is a developer tooling fix, not a security-sensitive feature.

    boundaries:
      - id: TB-001
        name: "Local Development Environment"
        description: "xtask runs in developer's local environment with full repo access"
        trust_level: HIGH
        entities:
          - "Developer workstation"
          - "Local git repository"

      - id: TB-002
        name: "GitHub API via gh CLI"
        description: "gh CLI handles authentication; credentials never in xtask memory"
        trust_level: DELEGATED
        entities:
          - "GitHub API"
          - "gh credential helper"

      - id: TB-003
        name: "External AI Tools"
        description: "Codex and Gemini CLIs are invoked as subprocesses"
        trust_level: EXTERNAL
        entities:
          - "codex CLI"
          - "gemini CLI"

  data_flows:
    - flow_id: DF-001
      description: "CI status retrieval"
      from: "GitHub API"
      to: "xtask check command"
      data: "JSON with check run status and conclusion"
      sensitivity: LOW

    - flow_id: DF-002
      description: "Status check creation"
      from: "xtask push command"
      to: "GitHub API"
      data: "Commit status (state, context, description)"
      sensitivity: LOW

    - flow_id: DF-003
      description: "Code review invocation"
      from: "xtask review command"
      to: "Codex/Gemini CLI"
      data: "PR URL and review prompt"
      sensitivity: LOW

  security_considerations: |
    These bug fixes do not introduce new security concerns:
    - JSON parsing is already done; we're just doing it more robustly
    - gh CLI argument passing is fixed to prevent shell injection
    - Codex CLI syntax change is API-correct invocation

    No credentials are handled directly by xtask; all authentication
    is delegated to the gh CLI and its credential helper.
