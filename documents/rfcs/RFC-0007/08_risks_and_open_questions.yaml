rfc_risks_and_open_questions:
  schema_version: "2026-01-25"
  template_version: "2026-01-25"

  risks:
    - id: RISK-001
      description: "mold not installed on developer machines"
      likelihood: MEDIUM
      impact: LOW
      mitigation: |
        Cargo will fail with a clear error message when mold is not found.
        Documentation includes installation instructions for common platforms.
        Developer can easily install mold or comment out the configuration.

    - id: RISK-002
      description: "clang not installed on developer machines"
      likelihood: LOW
      impact: LOW
      mitigation: |
        clang is commonly available on development systems. If missing,
        the error message is clear. Alternative: modify config to use
        gcc as the linker driver.

    - id: RISK-003
      description: "mold produces different binary behavior"
      likelihood: VERY_LOW
      impact: MEDIUM
      mitigation: |
        mold is a mature, widely-used linker. Binary output is functionally
        identical. All tests pass with mold linker. If issues arise, the
        configuration can be quickly reverted.

    - id: RISK-004
      description: "sccache cache corruption"
      likelihood: LOW
      impact: LOW
      mitigation: |
        sccache has built-in cache integrity checks. If corruption occurs,
        clearing the cache (~/.cache/sccache) resolves it. Worst case:
        full rebuild, no data loss.

    - id: RISK-005
      description: "Documentation becomes outdated"
      likelihood: MEDIUM
      impact: LOW
      mitigation: |
        Tools mentioned (sccache, nextest, mold) are stable and mature.
        Documentation should be reviewed periodically. Version-specific
        instructions are avoided where possible.

    - id: RISK-006
      description: "macOS/Windows developers affected by Linux config"
      likelihood: LOW
      impact: NONE
      mitigation: |
        Configuration is target-specific [target.x86_64-unknown-linux-gnu].
        macOS and Windows developers are unaffected. If mold support
        is desired on macOS, a separate target section can be added.

  open_questions:
    - id: OQ-001
      question: "Should we configure mold for macOS as well?"
      status: DEFERRED
      notes: |
        mold supports macOS but requires separate configuration:
        - Target: [target.aarch64-apple-darwin] for Apple Silicon
        - Target: [target.x86_64-apple-darwin] for Intel Macs
        - macOS uses sold (mold for macOS) which has some limitations
        Current RFC focuses on Linux where the tooling is already
        installed. macOS support can be added in a follow-up.

    - id: OQ-002
      question: "Should we add sccache to CI?"
      status: RESOLVED
      resolution: "No - GitHub Actions cache serves this purpose"
      notes: |
        CI already uses Swatinem/rust-cache for caching. Adding sccache
        to CI would add complexity without significant benefit. CI
        reproducibility is more important than CI build speed.

    - id: OQ-003
      question: "Should we mandate cargo-nextest?"
      status: RESOLVED
      resolution: "No - document as recommendation only"
      notes: |
        cargo test remains the official test runner. nextest is a
        recommendation for developers who want faster test execution.
        Mandating it would require CI changes and potential compatibility
        testing.

    - id: OQ-004
      question: "Should we add timing benchmarks to show improvement?"
      status: DEFERRED
      notes: |
        Collecting reproducible timing data would require controlled
        environment and multiple runs. The performance benefits of
        mold and sccache are well-documented externally. Developers
        can measure their own improvements.

  decisions_needed:
    - id: DN-001
      question: "Where to place build optimization docs in CONTRIBUTING.md?"
      options:
        - "New top-level section (chosen)"
        - "Under existing Development section"
        - "Separate BUILD_OPTIMIZATION.md file"
      chosen: "New top-level section"
      rationale: |
        Build optimization is important enough to warrant prominent
        placement. A new top-level section makes it discoverable.
        Keeping it in CONTRIBUTING.md avoids documentation sprawl.

    - id: DN-002
      question: "Should we provide a setup script?"
      options:
        - "No - manual setup is straightforward (chosen)"
        - "Yes - shell script to configure everything"
        - "Yes - cargo xtask setup-dev command"
      chosen: "No - manual setup is straightforward"
      rationale: |
        The setup steps are simple: install tools and add environment
        variables. A script adds maintenance burden. Manual setup
        ensures developers understand what's configured.
