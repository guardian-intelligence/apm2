rfc_contracts_and_versioning:
  schema_version: "2026-01-25"
  template_version: "2026-01-25"

  contracts:
    - id: CONTRACT-001
      name: ".cargo/config.toml linker configuration"
      description: |
        The project's .cargo/config.toml configures the mold linker for
        Linux x86_64 builds.
      interface:
        file: ".cargo/config.toml"
        configuration: |
          [target.x86_64-unknown-linux-gnu]
          linker = "clang"
          rustflags = ["-C", "link-arg=-fuse-ld=mold"]
        requirements:
          - "mold must be installed (typically at /usr/bin/mold)"
          - "clang must be installed (provides linker driver)"
        fallback: |
          If mold is not installed, cargo will fail with a clear error
          about the missing linker. Developer can either:
          1. Install mold: apt install mold (Ubuntu) or brew install mold (macOS)
          2. Comment out the configuration to use the default linker
      backward_compatible: true
      notes: |
        Configuration only affects Linux x86_64 target. Other platforms
        (macOS, Windows) continue using their default linkers.

    - id: CONTRACT-002
      name: "RUSTC_WRAPPER environment variable"
      description: |
        Developers MAY set RUSTC_WRAPPER=sccache in their shell profile
        to enable compilation caching.
      interface:
        variable: "RUSTC_WRAPPER"
        value: "sccache"
        scope: "Developer shell profile (optional)"
      backward_compatible: true
      notes: |
        This is a recommendation, not a requirement. The project builds
        correctly without sccache.

    - id: CONTRACT-003
      name: "CARGO_INCREMENTAL environment variable"
      description: |
        Local development SHOULD use CARGO_INCREMENTAL=1 for faster
        incremental builds. CI uses CARGO_INCREMENTAL=0 for reproducibility.
      interface:
        variable: "CARGO_INCREMENTAL"
        valid_values:
          - "0 - Disable incremental compilation"
          - "1 - Enable incremental compilation (default when unset)"
        local_value: "1 (recommended, also the default)"
        ci_value: "0 (set in ci.yml for reproducibility)"
      backward_compatible: true
      notes: |
        Default Cargo behavior is incremental=1, so this only matters if
        developers have explicitly set it to 0 in their environment.
        Setting CARGO_INCREMENTAL=1 explicitly documents the intent.

    - id: CONTRACT-004
      name: "cargo nextest run command"
      description: |
        Developers MAY use cargo nextest run as a faster alternative to
        cargo test.
      interface:
        command: "cargo nextest run"
        equivalent_to: "cargo test"
        flags: "Most cargo test flags supported"
      backward_compatible: true
      notes: |
        cargo test remains fully supported. nextest is a recommendation
        for faster local development.

  versioning:
    strategy: "No version bump required for configuration changes"
    rationale: |
      These are developer tooling configurations, not API changes. The
      changes improve developer experience without affecting the crates'
      public interfaces or functionality. Users of the published crates
      are unaffected.
