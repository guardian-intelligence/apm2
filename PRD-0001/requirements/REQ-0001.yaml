prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0001
  type: FUNCTIONAL
  title: Autonomous factory run command
  statement: 'The system MUST provide a single deterministic operator command that
    initiates an end-to-end autonomous software factory loop: PRD refinement (template-bound),
    RFC refinement (template-bound), ticket creation, ticket claiming, implementation,
    review, and merge gating, producing evidence bundles at each gate without human
    intervention during execution.'
  acceptance_criteria:
  - A single command invocation (e.g., apm2 factory run ...) triggers a workflow that
    produces or refines PRD and RFC artifacts that conform to the template suite and
    lint rules.
  - The same workflow decomposes work into atomic engineering tickets with stable
    IDs and requirement/evidence references.
  - At least one ticket is claimed via a lease and executed to completion with evidence
    and a merge-ready change produced.
  - The workflow reaches a terminal state (COMPLETE or ABORTED) with an evidence bundle
    that is replayable from captured artifacts.
  - 'The workflow fails closed: missing context, missing capabilities, or unmet evidence
    obligations result in explicit NEEDS_ADJUDICATION/ABORTED states with recorded
    rationale codes.'
  evidence:
    evidence_ids:
    - EVID-0001
    - EVID-0002
    - EVID-0016
    - EVID-0021
