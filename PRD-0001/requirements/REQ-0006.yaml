prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0006
  type: SECURITY
  title: Tamper-evident append-only ledger with signatures
  statement: Each node MUST maintain an append-only ledger of kernel events that is
    tamper-evident (hash chained) and attributable (signed records), enabling independent
    verification of work ownership, policy decisions, and produced evidence.
  acceptance_criteria:
  - Ledger records include seq, prev_hash, hash, record_version, and signer identity
    material.
  - Any mutation, deletion, or reordering of ledger records is detectable by hash
    chain verification.
  - Ledger records are signed over canonical encoded bytes and verified on ingestion.
  - Ledger segments and checkpoints include integrity metadata to detect truncation
    or gaps.
  - The ledger stores only references to large blobs; artifacts are content-addressed
    and verified by hash.
  evidence:
    evidence_ids:
    - EVID-0004
    - EVID-0016
