prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0008
  type: FUNCTIONAL
  title: Work lease mechanics are atomic and idempotent
  statement: Work ownership MUST be enforced via atomic lease claim/renew/release
    operations recorded in the ledger, preventing unbounded duplicate work while supporting
    failover when sessions die or partitions heal.
  acceptance_criteria:
  - A work lease claim is accepted only when there is no active lease or the active
    lease is expired per issuer rules.
  - Lease renewals extend only the currently active lease_id and are idempotent via
    dedupe_key.
  - Lease expiration is computed from event data; reducers do not depend on wall-clock
    time for replay correctness.
  - Lease conflicts after partition are detectable and converge deterministically
    under the configured resolution rule set.
  - Tool syscalls that mutate state require an active lease_id bound to the work_id
    unless explicitly permitted by profile.
  evidence:
    evidence_ids:
    - EVID-0006
